<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg"><head><title>Chapter 3. First Steps</title><link rel="stylesheet" type="text/css" href="core.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="up" href="index.html" title="Arduino Workshop: A hands-on introduction with 65 projects"/><link rel="prev" href="ch02.html" title="Chapter 2. Exploring the Arduino Board and the IDE"/><link rel="next" href="ch04.html" title="Chapter 4. Building Blocks"/></head><body><section class="chapter" title="Chapter 3. First Steps" epub:type="chapter" id="first_steps"><div class="titlepage"><div><div><h2 class="title">Chapter 3. First Steps</h2></div></div></div><p>In this chapter you will</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Learn the concepts of good project design</p></li><li class="listitem"><p>Learn the basic properties of electricity</p></li><li class="listitem"><p>Be introduced to the resistor, light-emitting diode (LED), transistor, rectifier diode, and relay</p></li><li class="listitem"><p>Use a solderless breadboard to construct circuits</p></li><li class="listitem"><p>Learn how integer variables, <code class="literal">for</code> loops, and digital outputs can be used to create various LED effects</p></li></ul></div><p>Now you’ll begin to bring your Arduino to life. As you will see, there is more to working with Arduino than just the board itself. You’ll learn how to plan projects in order to make your ideas a reality and then move on to a quick primer on electricity. Electricity is the driving force behind everything we do in this book, and it’s important to have a solid understanding of the basics in order to create your own projects. You’ll also take a look at the components that help bring real projects to life. Finally, you’ll examine some new functions that are the building blocks for your Arduino sketches.</p><div class="sect1" title="Planning Your Projects"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="planning_your_projects">Planning Your Projects</h2></div></div></div><p><a id="iddle1138" class="indexterm"/><a id="iddle1168" class="indexterm"/><a id="iddle1383" class="indexterm"/>When starting your first few projects, you might be tempted to write your sketch immediately after you’ve come up with a new idea. But before you start writing, a few basic preparatory steps are in order. After all, your Arduino board isn’t a mind-reader; it needs precise instructions, and even if these instructions can be executed by the Arduino, the results may not be what you expected if you overlooked even a minor detail.</p><p>Whether you are creating a project that simply blinks a light or an automated model railway signal, a detailed plan is the foundation of success. When designing your Arduino projects, follow these basic steps:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p title="Define your objective."><span class="title"><strong><span class="strong"><strong>Define your objective.</strong></span></strong></span> Determine what you want to achieve.</p></li><li class="listitem"><p title="Write your algorithm."><span class="title"><strong><span class="strong"><strong>Write your algorithm.</strong></span></strong></span> An <span class="emphasis"><em>algorithm</em></span> is a set of instructions that describes how to accomplish your project. Your algorithm will list the steps necessary for you to achieve your project’s objective.</p></li><li class="listitem"><p title="Select your hardware."><span class="title"><strong><span class="strong"><strong>Select your hardware.</strong></span></strong></span> Determine how it will connect to the Arduino.</p></li><li class="listitem"><p title="Write your sketch."><span class="title"><strong><span class="strong"><strong>Write your sketch.</strong></span></strong></span> Create your initial program that tells the Arduino what to do.</p></li><li class="listitem"><p title="Wire it up."><span class="title"><strong><span class="strong"><strong>Wire it up.</strong></span></strong></span> Connect your hardware, circuitry, and other items to the Arduino board.</p></li><li class="listitem"><p title="Test and debug."><span class="title"><strong><span class="strong"><strong>Test and debug.</strong></span></strong></span> Does it work? During this stage, you identify errors and find their causes, whether in the sketch, hardware, or algorithm.</p></li></ol></div><p>The more time you spend planning your project, the easier time you’ll have during the testing and debugging stage.</p><div class="note" title="Note"><h3 class="title"><a id="ch03note01"/>Note</h3><p><span class="emphasis"><em>Even well-planned projects sometimes fall prey to feature creep.</em></span> Feature creep <span class="emphasis"><em>occurs when people think up new functionality that they want to add to a project and then try to force new elements into an existing design. When you need to change a design, don’t try to “slot in” or modify it with 11th-hour additions. Instead, start fresh by redefining your objective.</em></span></p></div></div><div class="sect1" title="About Electricity"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="about_electricity">About Electricity</h2></div></div></div><p>Let’s spend a bit of time discussing electricity, since you’ll soon be building electronic circuits with your Arduino projects. In simple terms, <span class="emphasis"><em>electricity</em></span> is a form of energy that we can harness and convert into heat, light, movement, and power. Electricity has three main properties that will be important to us as we build projects: current, voltage, and power.</p><div class="sect2" title="Current"><div class="titlepage"><div><div><h3 class="title" id="current">Current</h3></div></div></div><p>The flow of electrical energy through a circuit is called the <span class="emphasis"><em>current</em></span>. Electrical current flows through a <span class="emphasis"><em>circuit</em></span> from the positive side of a power source, such as a battery, to the negative side of the power source. This is known as <span class="emphasis"><em>direct current (DC)</em></span>. For the purposes of this book, we will not deal with <a id="iddle1032" class="indexterm"/><a id="iddle1169" class="indexterm"/><a id="iddle1170" class="indexterm"/><a id="iddle1198" class="indexterm"/><a id="iddle1242" class="indexterm"/><a id="iddle1258" class="indexterm"/><a id="iddle1388" class="indexterm"/><a id="iddle1421" class="indexterm"/><a id="iddle1562" class="indexterm"/><a id="iddle1563" class="indexterm"/><a id="iddle1564" class="indexterm"/><span class="emphasis"><em>AC (alternating current)</em></span>. In some circuits, the negative side is called <span class="emphasis"><em>ground (GND)</em></span>. Current is measured in <span class="emphasis"><em>amperes</em></span> or “amps” (<span class="emphasis"><em>A</em></span>). Small amounts of current are measured in <span class="emphasis"><em>milliamps (mA)</em></span>, where 1,000 milliamps equal 1 amp.</p></div><div class="sect2" title="Voltage"><div class="titlepage"><div><div><h3 class="title" id="voltage">Voltage</h3></div></div></div><p><span class="emphasis"><em>Voltage</em></span> is a measure of the difference in potential energy between a circuit’s positive and negative ends. This is measured in <span class="emphasis"><em>volts (V)</em></span>. The greater the voltage, the faster the current moves through a circuit.</p></div><div class="sect2" title="Power"><div class="titlepage"><div><div><h3 class="title" id="power">Power</h3></div></div></div><p><span class="emphasis"><em>Power</em></span> is a measurement of the rate at which an electrical device converts energy from one form to another. Power is measured in <span class="emphasis"><em>watts (W)</em></span>. For example, a 100 W light bulb is much brighter than a 60 W bulb because the higher-wattage bulb converts more electrical energy into light.</p><p>A simple mathematical relationship exists among voltage, current, and power:</p><p>Power (W) = Voltage (V) × Current (A)</p></div></div><div class="sect1" title="Electronic Components"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="electronic_components">Electronic Components</h2></div></div></div><p>Now that you know a little bit about the basics of electricity, let’s look at how it interacts with various electronic components and devices. Electronic <span class="emphasis"><em>components</em></span> are the various parts that control electric current in a circuit to make our designs a reality. Just as the various parts of a car work together to provide fuel, power, and mobility to allow us to drive, electronic components work together to control and harness electricity to help us create useful devices.</p><p>Throughout this book, I’ll explain specialized components as we use them. The following sections describe some of the fundamental components.</p><div class="sect2" title="The Resistor"><div class="titlepage"><div><div><h3 class="title" id="resistor">The Resistor</h3></div></div></div><p>Various components, such as the Arduino’s LED, require only a small amount of current to function—usually around 10 mA. When the LED receives excess current, it converts the excess to heat—too much of which can kill an LED. To reduce the flow of current to components such as LEDs, we can add a <span class="emphasis"><em>resistor</em></span> between the voltage source and the component. Current flows freely along normal copper wire, but when it encounters a resistor, its movement is slowed. Some current is converted into a small amount of heat energy, which is proportional to the value of the resistor. <a class="xref" href="ch03.html#typical_resistors" title="Figure 3-1. Typical resistors">Figure 3-1</a> shows an example of commonly used resistors.</p><div class="figure"><a id="typical_resistors"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00042"/><img src="httpatomoreillycomsourcenostarchimages1629846.png.jpg" alt="Typical resistors"/></div></div><div class="figure-title">Figure 3-1. Typical resistors</div></div><div class="sect3" title="Resistance"><div class="titlepage"><div><div><h4 class="title" id="resistance">Resistance</h4></div></div></div><p><a id="iddle1372" class="indexterm"/><a id="iddle1422" class="indexterm"/><a id="iddle1425" class="indexterm"/>The level of resistance can be either fixed or variable. Resistance is measured in <span class="emphasis"><em>ohms</em></span> (Ω) and can range from zero to thousands of ohms (<span class="emphasis"><em>kiloohms</em></span>, or kΩ) to millions of ohms (<span class="emphasis"><em>megohms</em></span>, or MΩ).</p></div><div class="sect3" title="Reading Resistance Values"><div class="titlepage"><div><div><h4 class="title" id="reading_resistance_values">Reading Resistance Values</h4></div></div></div><p>Resistors are very small, so their resistance value usually cannot be printed on the components themselves. Although you can test resistance with a multimeter, you can also read resistance directly from a physical resistor, even without numbers. One common way to show the component’s resistance is with a series of color-coded bands, read from left to right, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: none"><p title="First band"><span class="title"><strong><span class="strong"><strong>First band</strong></span></strong></span>. Represents the first digit of the resistance</p></li><li class="listitem" style="list-style-type: none"><p title="Second band"><span class="title"><strong><span class="strong"><strong>Second band</strong></span></strong></span>. Represents the second digit of the resistance</p></li><li class="listitem" style="list-style-type: none"><p title="Third band"><span class="title"><strong><span class="strong"><strong>Third band</strong></span></strong></span>. Represents the multiplier (for four-band resistors) or the third digit (for five-band resistors)</p></li><li class="listitem" style="list-style-type: none"><p title="Fourth band"><span class="title"><strong><span class="strong"><strong>Fourth band</strong></span></strong></span>. Represents the multiplier for five-band resistors</p></li><li class="listitem" style="list-style-type: none"><p title="Fifth band"><span class="title"><strong><span class="strong"><strong>Fifth band</strong></span></strong></span>. Shows the tolerance (accuracy)</p></li></ul></div><p><a class="xref" href="ch03.html#values_of_bands_printed_on_a_resistorcom" title="Table 3-1. Values of Bands Printed on a Resistor, in Ohms">Table 3-1</a> lists the colors of resistors and their corresponding values.</p><p>The fifth band represents a resistor’s <span class="emphasis"><em>tolerance</em></span>. This is a measure of the accuracy of the resistor. Because it is difficult to manufacture resistors with exact values, you select a margin of error as a percentage when buying a resistor. A brown band indicates 1 percent, gold indicates 5 percent, and silver indicates 10 percent tolerance.</p><p><a class="xref" href="ch03.html#example_resistor_diagram" title="Figure 3-2. Example resistor diagram">Figure 3-2</a> shows a resistor diagram. The yellow, violet, and orange resistance bands are read as 4, 7, and 3, respectively, as listed in <a class="xref" href="ch03.html#values_of_bands_printed_on_a_resistorcom" title="Table 3-1. Values of Bands Printed on a Resistor, in Ohms">Table 3-1</a>. These values translate to 47,000 Ω, more commonly read as 47 kΩ.</p><div class="figure"><a id="example_resistor_diagram"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00043"/><img src="httpatomoreillycomsourcenostarchimages1629848.png.jpg" alt="Example resistor diagram"/></div></div><div class="figure-title">Figure 3-2. Example resistor diagram</div></div><div class="table"><a id="values_of_bands_printed_on_a_resistorcom"/><div class="table-title">Table 3-1. Values of Bands Printed on a Resistor, in Ohms</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"/><col class="c2"/></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Color</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Ohms</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Black</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>0</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Brown</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>1</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Red</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>2</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Orange</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>3</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Yellow</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>4</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Green</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>5</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Blue</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>6</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Violet</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>7</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Gray</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>8</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>White</p></td><td style="vertical-align: top; "><p>9</p></td></tr></tbody></table></div></div></div><div class="sect3" title="Chip Resistors"><div class="titlepage"><div><div><h4 class="title" id="chip_resistors">Chip Resistors</h4></div></div></div><p>Surface-mount chip resistors display a printed number and letter code, as shown in <a class="xref" href="ch03.html#example_of_a_surface-mount_resistor" title="Figure 3-3. Example of a surface-mount resistor">Figure 3-3</a>, instead of color stripes. The first two digits represent a single number, and the third digit represents the number of zeros to follow that number. For example, the resistor in <a class="xref" href="ch03.html#example_of_a_surface-mount_resistor" title="Figure 3-3. Example of a surface-mount resistor">Figure 3-3</a> has a value of 10,000 Ω, or 10 kΩ.</p><div class="figure"><a id="example_of_a_surface-mount_resistor"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00044"/><img src="httpatomoreillycomsourcenostarchimages1629850.png.jpg" alt="Example of a surface-mount resistor"/></div></div><div class="figure-title">Figure 3-3. Example of a surface-mount resistor</div></div><div class="note" title="Note"><h3 class="title"><a id="ch03note02"/>Note</h3><p><span class="emphasis"><em>If you see a number and letter code on small chip resistors (such as</em></span> 01C), <span class="emphasis"><em>google</em></span> EIA-96 code calculator <span class="emphasis"><em>for lookup tables on that more involved code system</em></span>.</p></div></div><div class="sect3" title="Multimeters"><div class="titlepage"><div><div><h4 class="title" id="multimeters">Multimeters</h4></div></div></div><p><a id="iddle1365" class="indexterm"/><a id="iddle1423" class="indexterm"/>A <span class="emphasis"><em>multimeter</em></span> is an incredibly useful and relatively inexpensive piece of test equipment that can measure voltage, resistance, current, and more. For example, <a class="xref" href="ch03.html#multimeter_measuring_a_560-ohm_1_percent" title="Figure 3-4. Multimeter measuring a 560-ohm 1 percent tolerance resistor">Figure 3-4</a> shows a multimeter measuring a resistor.</p><div class="figure"><a id="multimeter_measuring_a_560-ohm_1_percent"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00045"/><img src="httpatomoreillycomsourcenostarchimages1629852.png.jpg" alt="Multimeter measuring a 560-ohm 1 percent tolerance resistor"/></div></div><div class="figure-title">Figure 3-4. Multimeter measuring a 560-ohm 1 percent tolerance resistor</div></div><p>If you are colorblind, a multimeter is essential. As with other good tools, purchase your multimeter from a reputable retailer instead of fishing about on the Internet for the cheapest one you can find.</p></div><div class="sect3" title="Power Rating"><div class="titlepage"><div><div><h4 class="title" id="power_rating">Power Rating</h4></div></div></div><p>The resistor’s <span class="emphasis"><em>power rating</em></span> is a measurement of the power, in watts, that it will tolerate before overheating or failing. The resistors shown in <a class="xref" href="ch03.html#typical_resistors" title="Figure 3-1. Typical resistors">Figure 3-1</a> are 1/4-watt resistors, which are the most commonly used resistors with the Arduino system.</p><p>When you’re selecting a resistor, consider the relationship among power, current, and voltage. The greater the current and/or voltage, the greater the resistor’s power.</p><p>Usually, the greater a resistor’s power rating, the greater its physical size. For example, the resistor shown in <a class="xref" href="ch03.html#five-watt_resistor" title="Figure 3-5. A 5-watt resistor">Figure 3-5</a> is a 5-watt resistor, which measures 26 mm long by 7.5 mm wide.</p><div class="figure"><a id="five-watt_resistor"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00046"/><img src="httpatomoreillycomsourcenostarchimages1629854.png.jpg" alt="A 5-watt resistor"/></div></div><div class="figure-title">Figure 3-5. A 5-watt resistor</div></div></div></div><div class="sect2" title="The Light-Emitting Diode"><div class="titlepage"><div><div><h3 class="title" id="light-emitting_diode">The Light-Emitting Diode</h3></div></div></div><p><a id="iddle1183" class="indexterm"/><a id="iddle1317" class="indexterm"/><a id="iddle1322" class="indexterm"/><a id="iddle1334" class="indexterm"/>The LED is a very common, infinitely useful component that converts electrical current into light. LEDs come in various shapes, sizes, and colors. <a class="xref" href="ch03.html#red_ledcomma_5_mm_in_diameter" title="Figure 3-6. Red LED, 5 mm in diameter">Figure 3-6</a> shows a common LED.</p><div class="figure"><a id="red_ledcomma_5_mm_in_diameter"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00047"/><img src="httpatomoreillycomsourcenostarchimages1629856.png.jpg" alt="Red LED, 5 mm in diameter"/></div></div><div class="figure-title">Figure 3-6. Red LED, 5 mm in diameter</div></div><p>Connecting LEDs in a circuit takes some care, because they are <span class="emphasis"><em>polarized</em></span>; this means that current can enter and leave the LED in one direction only. The current enters via the <span class="emphasis"><em>anode</em></span> (positive) side and leaves via the <span class="emphasis"><em>cathode</em></span> (negative) side, as shown in <a class="xref" href="ch03.html#current_flow_through_an_led" title="Figure 3-7. Current flow through an LED">Figure 3-7</a>. Any attempt to make too much current flow through an LED in the opposite direction will break the component.</p><p>Thankfully, LEDs are designed so that you can tell which end is which. The leg on the anode side is longer, and the rim at the base of the LED is flat on the cathode side, as shown in <a class="xref" href="ch03.html#led_design_indicates_the_anode_left_pare" title="Figure 3-8. LED design indicates the anode (longer leg) and cathode (flat rim) sides.">Figure 3-8</a>.</p><div class="figure"><a id="current_flow_through_an_led"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00048"/><img src="httpatomoreillycomsourcenostarchimages1629858.png.jpg" alt="Current flow through an LED"/></div></div><div class="figure-title">Figure 3-7. Current flow through an LED</div></div><div class="figure"><a id="led_design_indicates_the_anode_left_pare"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00049"/><img src="httpatomoreillycomsourcenostarchimages1629860.png.jpg" alt="LED design indicates the anode (longer leg) and cathode (flat rim) sides."/></div></div><div class="figure-title">Figure 3-8. LED design indicates the anode (longer leg) and cathode (flat rim) sides.</div></div><p>When adding LEDs to a project, you need to consider the operating voltage and current. For example, common red LEDs require around 1.7 V and 5 to 20 mA of current. This presents a slight problem for us, because the Arduino outputs a set 5 V and a much higher current. Luckily, we can use a <span class="emphasis"><em>current-limiting resistor</em></span> to reduce the current flow into an LED. But which value resistor do we use? That’s where Ohm’s Law comes in.</p><p><a id="iddle1324" class="indexterm"/><a id="iddle1373" class="indexterm"/>To calculate the required current-limiting resistor for an LED, use this formula:</p><p>R = (V<sub>s</sub> − V<sub>f</sub>) ÷ I</p><p>where <span class="emphasis"><em>V<sub>s</sub></em></span> is the supply voltage (Arduino outputs 5 V); <span class="emphasis"><em>V<sub>f</sub></em></span> is the LED forward voltage drop (say, 1.7 V), and <span class="emphasis"><em>I</em></span> is the current required for the LED (10 mA). (The value of <span class="emphasis"><em>I</em></span> must be in amps, so 10 mA converts to 0.01 A.)</p><p>Now let’s use this for our LEDs—with a value of 5 V for <span class="emphasis"><em>V<sub>s</sub></em></span>, 1.7 V for <span class="emphasis"><em>V<sub>f</sub></em></span>, and 0.01 A for <span class="emphasis"><em>I</em></span>. Substituting these values into the formula gives a value for <span class="emphasis"><em>R</em></span> of 330 Ω. However, the LEDs will happily light up when fed current less than 10 mA. It’s good practice to use lower currents when possible to protect sensitive electronics, so we’ll use 560 Ω, 1/4-watt resistors with our LEDs, which allow around 6 mA of current to flow.</p><div class="note" title="Note"><h3 class="title"><a id="ch03note03"/>Note</h3><p><span class="emphasis"><em>When in doubt, always choose a slightly higher value resistor, because it’s better to have a dim LED than a dead one!</em></span></p></div><div class="sidebar"><a id="ohmapostrophes_law_triangle"/><div class="sidebar-title">The Ohm’s Law Triangle</div><p>Ohm’s Law states that the relationship between current, resistance, and voltage is as follows:</p><p>voltage (V) = current (I) × resistance (R)</p><p>If you know two of the quantities, then you can calculate the third. A popular way to remember Ohm’s Law is with a triangle, as shown in <a class="xref" href="ch03.html#ohmapostrophes_law_triangle-id00010" title="Figure 3-9. The Ohm’s Law triangle">Figure 3-9</a>.</p><div class="figure"><a id="ohmapostrophes_law_triangle-id00010"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00050"/><img src="httpatomoreillycomsourcenostarchimages1629862.png.jpg" alt="The Ohm’s Law triangle"/></div></div><div class="figure-title">Figure 3-9. The Ohm’s Law triangle</div></div><p>The Ohm’s Law triangle diagram is a convenient tool for calculating voltage, current, or resistance when two of the three values are known. For example, if you need to calculate resistance, put your finger over <span class="emphasis"><em>R</em></span>, which leaves you with voltage divided by current; to calculate voltage, cover V, which leaves you with current times resistance.</p></div></div><div class="sect2" title="The Solderless Breadboard"><div class="titlepage"><div><div><h3 class="title" id="solderless_breadboard">The Solderless Breadboard</h3></div></div></div><p><a id="iddle1480" class="indexterm"/>Our ever-changing circuits will need a base—something to hold them together and build upon. A great tool for this purpose is a <span class="emphasis"><em>solderless breadboard</em></span>. The breadboard is a plastic base with rows of electrically connected sockets (just don’t cut bread on them). They come in many sizes, shapes, and colors, as shown in <a class="xref" href="ch03.html#breadboards_in_various_shapes_and_sizes" title="Figure 3-10. Breadboards in various shapes and sizes">Figure 3-10</a>.</p><div class="figure"><a id="breadboards_in_various_shapes_and_sizes"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00051"/><img src="httpatomoreillycomsourcenostarchimages1629864.png.jpg" alt="Breadboards in various shapes and sizes"/></div></div><div class="figure-title">Figure 3-10. Breadboards in various shapes and sizes</div></div><p>The key to using a breadboard is knowing how the sockets are connected—whether in short columns or in long rows along the edge or in the center. The connections vary by board. For example, in the breadboard shown at the top of <a class="xref" href="ch03.html#breadboard_internal_connections" title="Figure 3-11. Breadboard internal connections">Figure 3-11</a>, columns of five holes are connected vertically but isolated horizontally. If you place two wires in one vertical row, then they will be electrically connected. By the same token, the long rows in the center between the horizontal lines are connected horizontally. Because you’ll often need to connect a circuit to the supply voltage and ground, these long horizontal lines of holes are ideal for the supply voltage and ground.</p><p>When you’re building more complex circuits, a breadboard will get crowded and you won’t always be able to place components exactly where you want. It’s easy to solve this problem using short connecting wires, however. Retailers that sell breadboards usually also sell small boxes of wires of various lengths, such as the assortment shown in <a class="xref" href="ch03.html#assorted_breadboard_wires" title="Figure 3-12. Assorted breadboard wires">Figure 3-12</a>.</p><div class="figure"><a id="breadboard_internal_connections"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00052"/><img src="httpatomoreillycomsourcenostarchimages1629866.png.jpg" alt="Breadboard internal connections"/></div></div><div class="figure-title">Figure 3-11. Breadboard internal connections</div></div><div class="figure"><a id="assorted_breadboard_wires"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00053"/><img src="httpatomoreillycomsourcenostarchimages1629868.png.jpg" alt="Assorted breadboard wires"/></div></div><div class="figure-title">Figure 3-12. Assorted breadboard wires</div></div></div></div><div class="sect1" title="Project #1: Creating a Blinking LED Wave"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="project_hash1_creating_a_blinking_led_wa">Project #1: Creating a Blinking LED Wave</h2></div></div></div><p><a id="iddle1097" class="indexterm"/><a id="iddle1307" class="indexterm"/>Let’s put some LEDs and resistors to work. In this project, we’ll use five LEDs to emulate the front of the famous TV show vehicle KITT from the television show <span class="emphasis"><em>Knight Rider</em></span>, creating a kind of wavelike light pattern.</p><div class="sect2" title="The Algorithm"><div class="titlepage"><div><div><h3 class="title" id="algorithm">The Algorithm</h3></div></div></div><p>Here’s our algorithm for this project:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Turn on LED 1.</p></li><li class="listitem"><p>Wait half a second.</p></li><li class="listitem"><p>Turn off LED 1.</p></li><li class="listitem"><p>Turn on LED 2.</p></li><li class="listitem"><p>Wait half a second.</p></li><li class="listitem"><p>Turn off LED 2.</p></li><li class="listitem"><p>Continue until LED 5 is turned on, at which point the process reverses from LED 5 to 1.</p></li><li class="listitem"><p>Repeat indefinitely.</p></li></ol></div></div><div class="sect2" title="The Hardware"><div class="titlepage"><div><div><h3 class="title" id="hardware">The Hardware</h3></div></div></div><p>Here’s what you’ll need to create this project:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Five LEDs</p></li><li class="listitem"><p>Five 560 Ω resistors</p></li><li class="listitem"><p>One breadboard</p></li><li class="listitem"><p>Various connecting wires</p></li><li class="listitem"><p>Arduino and USB cable</p></li></ul></div><p>We will connect the LEDs to digital pins 2 through 6 via the 560-ohm current-limiting resistors.</p></div><div class="sect2" title="The Sketch"><div class="titlepage"><div><div><h3 class="title" id="sketch">The Sketch</h3></div></div></div><p>Now for our sketch. Enter this code into the IDE:</p><a id="pro_id00009"/><pre class="programlisting">  // Project 1 - Creating a Blinking LED Wave
<span class="gray-background">1</span> void setup()
  {
    pinMode(2, OUTPUT);    // LED 1 control pin is set up as an output
    pinMode(3, OUTPUT);    // same for LED 2 to LED 5
    pinMode(4, OUTPUT);
    pinMode(5, OUTPUT);
    pinMode(6, OUTPUT);
  }

<span class="gray-background">2</span> void loop()
  {
    digitalWrite(2, HIGH);  // Turn LED 1 on
    delay(500);             // wait half a second
    digitalWrite(2, LOW);   // Turn LED 1 off
    digitalWrite(3, HIGH);  // and repeat for LED 2 to 5
    delay(500);
    digitalWrite(3, LOW);
    digitalWrite(4, HIGH);
    delay(500);
    digitalWrite(4, LOW);
    digitalWrite(5, HIGH);
    delay(500);
    digitalWrite(5, LOW);
    digitalWrite(6, HIGH);
    delay(500);
    digitalWrite(6, LOW);
    digitalWrite(5, HIGH);
    delay(500);
    digitalWrite(5, LOW);
    digitalWrite(4, HIGH);
    delay(500);
    digitalWrite(4, LOW);
    digitalWrite(3, HIGH);
    delay(500);
    digitalWrite(3, LOW);
    // the loop() will now loop around and start from the top again
  }</pre><p>In <code class="literal">void setup()</code> at <span class="gray-background">1</span>, the digital I/O pins are set to outputs, because we want them to send current to the LEDs on demand. We specify when to turn on each LED using the <code class="literal">digitalWrite()</code> function in the <code class="literal">void loop()</code> <span class="gray-background">2</span> section of the sketch.</p></div><div class="sect2" title="The Schematic"><div class="titlepage"><div><div><h3 class="title" id="schematic">The Schematic</h3></div></div></div><p>Now let’s build the circuit. Circuit layout can be described in several ways. For the first few projects in this book, we’ll use physical layout diagrams similar to the one shown in <a class="xref" href="ch03.html#circuit_layout_for_project_1" title="Figure 3-13. Circuit layout for Project 1">Figure 3-13</a>.</p><p>By comparing the wiring diagram to the functions in the sketch, you can begin to make sense of the circuit. For example, when we use <code class="literal">digitalWrite(2, HIGH)</code>, a high voltage of 5 V flows from digital pin 2, through the current-limiting resistor, through the LED via the anode and then the cathode, and finally back to the Arduino’s GND socket to complete the circuit. Then, when we use <code class="literal">digitalWrite(2, LOW)</code>, the current stops and the LED turns off.</p><div class="figure"><a id="circuit_layout_for_project_1"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00054"/><img src="httpatomoreillycomsourcenostarchimages1629870.png.jpg" alt="Circuit layout for Project 1"/></div></div><div class="figure-title">Figure 3-13. Circuit layout for Project 1</div></div></div><div class="sect2" title="Running the Sketch"><div class="titlepage"><div><div><h3 class="title" id="running_the_sketch">Running the Sketch</h3></div></div></div><p><a id="iddle1551" class="indexterm"/>Now connect your Arduino and upload the sketch. After a second or two, the LEDs should blink from left to right and then back again. Success is a wonderful thing—embrace it!</p><p>If nothing happens, however, then immediately remove the USB cable from the Arduino and check that you typed the sketch correctly. If you find an error, fix it and upload your sketch again. If your sketch matches exactly and the LEDs still don’t blink, check your wiring on the breadboard.</p><p>You now know how to make an LED blink with your Arduino, but this sketch is somewhat inefficient. For example, if you wanted to modify this sketch to make the LEDs cycle more quickly, you would need to alter each <code class="literal">delay(500)</code>. There is a better way.</p></div></div><div class="sect1" title="Using Variables"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="using_variables">Using Variables</h2></div></div></div><p>In computer programs, we use <span class="emphasis"><em>variables</em></span> to store data. For example, in the sketch for Project 1, we used the function <code class="literal">delay(500)</code> to keep the LEDs turned on.</p><p><a id="iddle1283" class="indexterm"/><a id="iddle1284" class="indexterm"/><a id="iddle1420" class="indexterm"/><a id="iddle1554" class="indexterm"/>The problem with the sketch as written is that it’s not very flexible. If we want to make a change to the delay time, then we have to change each entry manually. To address this problem, we’ll create a variable to represent the value for the <code class="literal">delay()</code> function.</p><p>Enter the following line in the Project 1 sketch above the <code class="literal">void setup()</code> function and just after the initial comment:</p><a id="pro_id00010"/><pre class="programlisting"><span class="strong"><strong>int d = 250;</strong></span></pre><p>This assigns the number <code class="literal">250</code> to a variable called <code class="literal">d</code>.</p><p>Next, change every <code class="literal">500</code> in the sketch to a <code class="literal">d</code>. Now when the sketch runs, the Arduino will use the value in <code class="literal">d</code> for the <code class="literal">delay()</code> functions. When you upload the sketch after making these changes, the LEDs will turn on and off at a much faster rate, as the delay value is much smaller at the <code class="literal">250</code> value.</p><p><code class="literal">int</code> indicates that the variable contains an integer—a whole number between −32,768 and 32,767. Simply put, any integer value has no fraction or decimal places. Now, to alter the delay, simply change the variable declaration at the start of the sketch. For example, entering <code class="literal">100</code> for the delay would speed things up even more:</p><a id="pro_id00011"/><pre class="programlisting"><span class="strong"><strong>int d = 100;</strong></span></pre><p>Experiment with the sketch, perhaps altering the delays and the sequence of <code class="literal">HIGH</code> and <code class="literal">LOW</code>. Have some fun with it. Don’t disassemble the circuit yet, though; we’ll continue to use it with more projects in this chapter.</p></div><div class="sect1" title="Project #2: Repeating with for Loops"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="project_hash2_repeating_with_for_loops">Project #2: Repeating with for Loops</h2></div></div></div><p>When designing a sketch, you’ll often repeat the same function. You could simply copy and paste the function to duplicate it in a sketch, but that’s inefficient and a waste of your Arduino’s program memory. Instead, you can use <code class="literal">for</code> loops. The benefit of using a <code class="literal">for</code> loop is that you can determine how many times the code inside the loop will repeat.</p><p>To see how a <code class="literal">for</code> loop works, enter the following code as a new sketch:</p><a id="pro_id00012"/><pre class="programlisting">// Project 2 - Repeating with for Loops
int d = 100;

void setup()
{
  pinMode(2, OUTPUT);
  pinMode(3, OUTPUT);
  pinMode(4, OUTPUT);
  pinMode(5, OUTPUT);
  pinMode(6, OUTPUT);
}

void loop()
{
 for ( int a = 2; a &lt; 7 ; a++ )
  {
    digitalWrite(a, HIGH);
    delay(d);
    digitalWrite(a, LOW);
    delay(d);
  }
}</pre><p><a id="iddle1220" class="indexterm"/><a id="iddle1325" class="indexterm"/><a id="iddle1393" class="indexterm"/><a id="iddle1402" class="indexterm"/>The <code class="literal">for</code> loop will repeat the code within the curly brackets beneath it as long as some condition is true. Here, we have used a new integer variable, <code class="literal">a</code>, which starts with the value <code class="literal">2</code>. Every time the code is executed, the <code class="literal">a++</code> will add 1 to the value of <code class="literal">a</code>. The loop will continue in this fashion while the value of <code class="literal">a</code> is less than 7 (the condition). Once it is equal to or greater than 7, the Arduino moves on and continues with whatever code comes after the <code class="literal">for</code> loop.</p><p>The number of loops that a <code class="literal">for</code> loop executes can also be set by counting down from a higher number to a lower number. To demonstrate this, add the following loop to the Project 2 sketch after the first <code class="literal">for</code> loop:</p><a id="pro_id00013"/><pre class="programlisting"><span class="gray-background">1</span> for ( int a = 5 ; a &gt; 1 ; a-- )
    {
      digitalWrite(a, HIGH);
      delay(d);
      digitalWrite(a, LOW);
      delay(d);
    }</pre><p>Here, the <code class="literal">for</code> loop at <span class="gray-background">1</span> sets the value of <code class="literal">a</code> equal to <code class="literal">5</code> and then subtracts 1 after every loop due to the <code class="literal">a--</code>. The loop continues in this manner while the value for <code class="literal">a</code> is greater than 1 (<code class="literal">a &gt; 1</code>) and finishes once the value of <code class="literal">a</code> falls to 1 or less than 1.</p><p>We have now re-created Project 1 using less code. Upload the sketch and see for yourself!</p></div><div class="sect1" title="Varying LED Brightness with Pulse-Width Modulation"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="varying_led_brightness_with_pulse-width">Varying LED Brightness with Pulse-Width Modulation</h2></div></div></div><p>Rather than just turning LEDs on and off rapidly using <code class="literal">digitalWrite()</code>, we can define the level of brightness of an LED by adjusting the amount of time between each LED’s on and off states using <span class="emphasis"><em>pulse-width modulation (PWM)</em></span>. PWM can be used to create the illusion of an LED being on at different levels of brightness by turning the LED on and off rapidly, at around 500 cycles per second. The brightness we perceive is determined by the amount of time the digital output pin is on versus the amount of time it is off—that is, every time the LED is lit or unlit. Because our eyes can’t see flickers faster than 50 cycles per second, the LED appears to have a constant brightness.</p><p><a id="iddle1035" class="indexterm"/><a id="iddle1152" class="indexterm"/><a id="iddle1395" class="indexterm"/><a id="iddle1396" class="indexterm"/>The greater the <span class="emphasis"><em>duty cycle</em></span> (the longer the pin is on compared to off in each cycle), the greater the perceived brightness of the LED connected to the digital output pin.</p><p><a class="xref" href="ch03.html#various_pwm_duty_cycles" title="Figure 3-14. Various PWM duty cycles">Figure 3-14</a> shows various PWM duty cycles. The filled-in gray areas represent the amount of time that the light is on. As you can see, the amount of time per cycle that the light is on increases with the duty cycle.</p><div class="figure"><a id="various_pwm_duty_cycles"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00055"/><img src="httpatomoreillycomsourcenostarchimages1629872.png.jpg" alt="Various PWM duty cycles"/></div></div><div class="figure-title">Figure 3-14. Various PWM duty cycles</div></div><p>Only digital pins 3, 5, 6, 9, 10, and 11 on a regular Arduino board can be used for PWM. They are marked on the Arduino board with a tilde (~), as shown in <a class="xref" href="ch03.html#pwm_pins_are_marked_with_a_tilde_left_pa" title="Figure 3-15. The PWM pins are marked with a tilde (~).">Figure 3-15</a>.</p><div class="figure"><a id="pwm_pins_are_marked_with_a_tilde_left_pa"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00056"/><img src="httpatomoreillycomsourcenostarchimages1629874.png.jpg" alt="The PWM pins are marked with a tilde (~)."/></div></div><div class="figure-title">Figure 3-15. The PWM pins are marked with a tilde (~).</div></div><p>To create a PWM signal, we use the function <code class="literal">analogWrite(x, y)</code>, where <code class="literal">x</code> is the digital pin and <code class="literal">y</code> is a value for the duty cycle, between 0 and 255, where 0 indicates a 0 percent duty cycle and 255 indicates 100 percent duty cycle.</p></div><div class="sect1" title="Project #3: Demonstrating PWM"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="project_hash3_demonstrating_pwm">Project #3: Demonstrating PWM</h2></div></div></div><p><a id="iddle1151" class="indexterm"/><a id="iddle1394" class="indexterm"/>Now let’s try this with our circuit from Project 2. Enter the following sketch into the IDE and upload it to the Arduino:</p><a id="pro_id00014"/><pre class="programlisting">// Project 3 - Demonstrating PWM
int d = 5;
void setup()
{
  pinMode(3, OUTPUT);    // LED control pin is 3, a PWM capable pin
}

void loop()
{
  for ( int a = 0 ; a &lt; 256 ; a++ )
  {
    analogWrite(3, a);
    delay(d);
  }

  for ( int a = 255 ; a &gt;= 0 ; a-- )
  {
    analogWrite(3, a);
    delay(d);
  }
  delay(200);
}</pre><p>The LED on digital pin 3 will exhibit a “breathing effect” as the duty cycle increases and decreases. In other words, the LED will turn on, increasing in brightness until fully lit, and then reverse. Experiment with the sketch and circuit. For example, make five LEDs breathe at once, or have them do so sequentially.</p></div><div class="sect1" title="More Electric Components"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="more_electric_components">More Electric Components</h2></div></div></div><p>You’ll usually find it easy to plan on having a digital output control do something without taking into account how much current the control really needs to get the job done. As you create your project, remember that each digital output pin on the Arduino Uno can offer a maximum of 40 mA of current per pin and 200 mA total for all pins. Three electronic hardware components can help you increase the current-handling ability of the Arduino, however, and are discussed next.</p><div class="warning" title="Warning" epub:type="warning"><h3 class="title"><a id="ch03note04"/>Warning</h3><p><span class="emphasis"><em>If you attempt to exceed 40 mA on a single pin, or 200 mA total, then you risk permanently damaging the microcontroller integrated circuit (IC).</em></span></p></div><div class="sect2" title="The Transistor"><div class="titlepage"><div><div><h3 class="title" id="transistor">The Transistor</h3></div></div></div><p><a id="iddle1085" class="indexterm"/><a id="iddle1155" class="indexterm"/><a id="iddle1177" class="indexterm"/><a id="iddle1204" class="indexterm"/><a id="iddle1206" class="indexterm"/><a id="iddle1532" class="indexterm"/><a id="iddle1534" class="indexterm"/>Almost everyone has heard of a <span class="emphasis"><em>transistor</em></span>, but most people don’t really understand how it works. In the spirit of brevity, I will keep the explanation as simple as possible. A transistor can turn on or off the flow of a much larger current than the Arduino Uno can handle. We can, however, safely control a transistor using an Arduino digital output pin. A popular example is the BC548, shown in <a class="xref" href="ch03.html#typical_transistor_the_bc548" title="Figure 3-16. A typical transistor: the BC548">Figure 3-16</a>.</p><div class="figure"><a id="typical_transistor_the_bc548"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00057"/><img src="httpatomoreillycomsourcenostarchimages1629876.png.jpg" alt="A typical transistor: the BC548"/></div></div><div class="figure-title">Figure 3-16. A typical transistor: the BC548</div></div><p>Similar to the LED, the transistor’s pins have a unique function and need to be connected in the proper orientation. With the flat front of the transistor facing you (as shown on the left of <a class="xref" href="ch03.html#typical_transistor_the_bc548" title="Figure 3-16. A typical transistor: the BC548">Figure 3-16</a>), the pins on the BC548 are called (from left to right) <span class="emphasis"><em>collector</em></span>, <span class="emphasis"><em>base</em></span>, and <span class="emphasis"><em>emitter</em></span>. (Note that this pin order, or pinout, is for the BC548 transistor; other transistors may be oriented differently.) When a small current is applied to the base, such as from an Arduino digital I/O pin, the larger current we want to switch enters through the collector; then it is combined with the small current from the base, and then it flows out via the emitter. When the small control current at the base is turned off, no current can flow through the transistor.</p><p>The BC548 can switch up to 100 mA of current at a maximum of 30 V—much more than the Arduino’s digital output. In projects later in the book, we will use this in other transistors, and at that time, you’ll read about transistors in more detail.</p><div class="note" title="Note"><h3 class="title"><a id="ch03note05"/>Note</h3><p><span class="emphasis"><em>Always pay attention to the pin order for your particular transistor, because each transistor can have its own orientation.</em></span></p></div></div><div class="sect2" title="The Rectifier Diode"><div class="titlepage"><div><div><h3 class="title" id="rectifier_diode">The Rectifier Diode</h3></div></div></div><p>The <span class="emphasis"><em>diode</em></span> is a very simple yet useful component that allows current to flow in one direction only. It looks a lot like a resistor, as you can see in <a class="xref" href="ch03.html#onen4004-type_rectifier_diode" title="Figure 3-17. A 1N4004-type rectifier diode">Figure 3-17</a>.</p><div class="figure"><a id="onen4004-type_rectifier_diode"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00058"/><img src="httpatomoreillycomsourcenostarchimages1629878.png.jpg" alt="A 1N4004-type rectifier diode"/></div></div><div class="figure-title">Figure 3-17. A 1N4004-type rectifier diode</div></div><p><a id="iddle1022" class="indexterm"/><a id="iddle1196" class="indexterm"/><a id="iddle1418" class="indexterm"/>The projects in this book will use the 1N4004-type rectifier diode. Current flows into the diode via the anode and out through the cathode, which is marked with the ring around the diode’s body. These diodes can protect parts of the circuit against reverse current flow, but there is a price to pay: diodes also cause a drop in the voltage of around 0.7 V. The 1N4004 diode is rated to handle 1 A and 400 V, much higher than we will be using. It’s a tough, common, and low-cost diode.</p></div><div class="sect2" title="The Relay"><div class="titlepage"><div><div><h3 class="title" id="relay">The Relay</h3></div></div></div><p><span class="emphasis"><em>Relays</em></span> are used for the same reason as transistors—to control a much larger current and voltage. A relay has the advantage of being <span class="emphasis"><em>electrically isolated</em></span> from the control circuit, which allows the Arduino to switch very large currents and voltages. Isolation is sometimes necessary to protect circuits from these very large currents and voltages, which can damage an Arduino. Inside the relay is an interesting pair of items: mechanical switch contacts and a low-voltage coil of wire, as shown in <a class="xref" href="ch03.html#inside_a_typical_relay" title="Figure 3-18. Inside a typical relay">Figure 3-18</a>.</p><div class="figure"><a id="inside_a_typical_relay"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00059"/><img src="httpatomoreillycomsourcenostarchimages1629880.png.jpg" alt="Inside a typical relay"/></div></div><div class="figure-title">Figure 3-18. Inside a typical relay</div></div><p><a id="iddle1207" class="indexterm"/><a id="iddle1261" class="indexterm"/><a id="iddle1535" class="indexterm"/>When a current is applied to the coil, the component becomes an electromagnet and attracts a bar of metal that acts just like the toggle of a switch. The magnet pulls the bar in one direction when on and lets it fall back when off, thereby turning it on or off as current is applied and removed from the coil. This movement has a distinctive “click” that you might recognize from the turn signal in older cars.</p></div></div><div class="sect1" title="Higher-Voltage Circuits"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="higher-voltage_circuits">Higher-Voltage Circuits</h2></div></div></div><p>Now that you understand a bit about the transistor, rectifier diode, and relay, let’s use them together to control higher currents and voltages. Connecting the components is very simple, as shown in <a class="xref" href="ch03.html#relay_control_circuit" title="Figure 3-19. Relay control circuit">Figure 3-19</a>.</p><div class="figure"><a id="relay_control_circuit"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00060"/><img src="httpatomoreillycomsourcenostarchimages1629882.png.jpg" alt="Relay control circuit"/></div></div><div class="figure-title">Figure 3-19. Relay control circuit</div></div><p>This simple example circuit controls a relay that has a 12 V coil. One use for this circuit would be to control a lamp or cooling fan connected to the relay switching contacts. The Arduino’s digital pin 10 is connected to the transistor’s base via a 1 kΩ resistor. The transistor controls the current through the relay’s coil by switching it on and off. Remember that the pins are <span class="emphasis"><em>C</em></span>, <span class="emphasis"><em>B</em></span>, and then <span class="emphasis"><em>E</em></span> when looking at the flat surface of the transistor. The object on the left of the breadboard at <span class="gray-background">1</span> represents a 12 V power supply for the relay coil. The negative or ground at <span class="gray-background">2</span> from the 12 V supply, the transistor’s emitter pin, and Arduino GND are all connected together. Finally, a 1N4004 rectifier diode is connected across the relay’s coil at <span class="gray-background">3</span>, with the cathode on the positive supply side. You can check the relay’s data sheet to determine the pins for the contacts and to connect the controlled item appropriately.</p><p>The diode is in place to protect the circuit. When the relay coil changes from on to off, stray current remains briefly in the coil and becomes a high-voltage spike that has to go somewhere. The diode allows the stray current to loop around through the coil until it is dissipated as a tiny amount of heat. It prevents the turn-off spike from damaging the transistor or Arduino pin.</p><div class="warning" title="Warning" epub:type="warning"><h3 class="title"><a id="ch03note06"/>Warning</h3><p><span class="emphasis"><em>If you want to control mains-rated electricity (110–250 V) at a high current with a relay, contact a licensed electrician to complete this work for you. Even the slightest mistake can be fatal.</em></span></p></div></div><div class="sect1" title="Looking Ahead"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="looking_ahead-id00011">Looking Ahead</h2></div></div></div><p>And now <a class="xref" href="ch03.html" title="Chapter 3. First Steps">Chapter 3</a> draws to a close. I hope you had fun trying out the examples and experimented with LED effects. In this chapter, you got to create blinking LEDs on the Arduino in various ways, did a bit of hacking, and learned how functions and loops can be used efficiently to control components connected to the Arduino. Studying this chapter has set you up for more success in the forthcoming chapters.</p><p><a class="xref" href="ch04.html" title="Chapter 4. Building Blocks">Chapter 4</a> will be a lot of fun. You will create some actual projects, including traffic lights, a thermometer, a battery tester, and more—so when you’re ready to take it to the next level, turn the page!</p></div></section></body></html>
